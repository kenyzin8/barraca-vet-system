{% extends 'customer_dashboard/base.html' %}

{% block title %} Pet - {{ pet.name }} | Barraca Veterinary Clinic {% endblock %}

<a href="{% url 'pet-list-page' %}">Back</a>

{% block extrastyles %}
<style>
    .nav-wizard .nav-link 
    {
        padding: 0.5rem;
    }
    .nav-pills .nav-link.active, .nav-pills .show > .nav-link 
    {
        color: white;
        background-color: #121212;
    }

    .nav-wizard .nav-link .wizard-step-icon 
    {
        background-color: #121212;
    }

    .nav-wizard .nav-link .wizard-step-text .wizard-step-text-name 
    {
        color: #121212;
    }

    .nav-wizard .nav-link.active .wizard-step-icon i, .nav-wizard .nav-link.active .wizard-step-icon svg, .nav-wizard .nav-link.active .wizard-step-icon .feather 
    {
    color: #121212;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-5 animated--fade-in-up">
    <nav class="mt-4 rounded mb-3" aria-label="breadcrumb">
        <ol class="breadcrumb py-2 rounded mb-0">
            <li class="breadcrumb-item"><a href="{% url 'pet-list-page' %}">My Pets</a></li>
            <li class="breadcrumb-item active">{{ pet.name }}</li>
        </ol>
    </nav>
        <!-- Wizard card example with navigation-->
        <div class="card">
            <div class="card-header border-bottom">
                <!-- Wizard navigation-->
                <div class="nav nav-pills nav-justified flex-column flex-xl-row nav-wizard" id="cardTab" role="tablist">
                    <!-- Wizard navigation item 1-->
                    <a class="nav-item nav-link active" id="wizard1-tab" href="#wizard1" data-bs-toggle="tab" role="tab" aria-controls="wizard1" aria-selected="true">
                        <div class="wizard-step-icon"><i data-feather="info"></i></div>
                        <div class="wizard-step-text">
                            <div class="wizard-step-text-name">Pet Information</div>
                        </div>
                    </a>
                    <!-- Wizard navigation item 2-->
                    <a class="nav-item nav-link" id="wizard2-tab" href="#wizard2" data-bs-toggle="tab" role="tab" aria-controls="wizard2" aria-selected="true">
                        <div class="wizard-step-icon"><i data-feather="heart"></i></div>
                        <div class="wizard-step-text">
                            <div class="wizard-step-text-name">Health Card</div>
                        </div>
                    </a>
                    <!-- Wizard navigation item 3-->
                    <a class="nav-item nav-link" id="wizard3-tab" href="#wizard3" data-bs-toggle="tab" role="tab" aria-controls="wizard3" aria-selected="true">
                        <div class="wizard-step-icon"><i data-feather="activity"></i></div>
                        <div class="wizard-step-text">
                            <div class="wizard-step-text-name">Medical Record</div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="card-body">
                <div class="tab-content" id="cardTabContent">
                    <!-- Wizard tab pane item 1-->
                    <div class="tab-pane py-5 py-xl-2 fade show active" id="wizard1" role="tabpanel" aria-labelledby="wizard1-tab">
                        <div class="row justify-content-center">
                            <div class="col-md-6">
                                <h1>{{ pet.name }}</h1>
                                <br>
                                <p>Species: {{ pet.species }}</p>
                                <p>Breed: {{ pet.breed }}</p>
                                <p>Birthday: {{ pet.birthday }}</p>
                                <p>Age: {{ pet.age }}</p>
                                <p>Gender: {{ pet.gender }}</p>
                                <p>Color: {{ pet.color }}</p>
                                <p>Weight: {{ pet.weight }}</p>
                                {% if appointment.pet == pet %}<p>Appointment: {{ appointment.date }} {{ appointment.timeOfTheDay }} for {{ appointment.purpose }}</p>{% endif %}
                                <!-- <p>Owner: {{ pet.client }}</p> -->
                            </div>
                            <div class="col-md-6">
                                <img src="{{ pet.picture.url }}" alt="{{ pet.name }}" class="img-fluid" style="border-radius: 10px;">
                            </div>
                            <div>
                                <br>
                                <a href="{% url 'update-pet-page' pet.id %}" class="btn btn-dark lift lift-sm">Update</a>
                                <!-- <a href="{% url 'delete-pet-page' pet.id %}" class="btn btn-dark">Delete</a> -->
                                <button class="btn btn-dark lift lift-sm" data-bs-toggle="modal" data-bs-target="#deletePetModal" data-pet-id="{{ pet.id }}">Delete</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Wizard tab pane item 2-->
                    <div class="tab-pane py-5 py-xl-2 fade" id="wizard2" role="tabpanel" aria-labelledby="wizard2-tab">
                        <div class="row justify-content-center">
                            Test
                        </div>
                    </div>
                    <!-- Wizard tab pane item 3-->
                    <div class="tab-pane py-5 py-xl-2 fade" id="wizard3" role="tabpanel" aria-labelledby="wizard3-tab">
                        <div class="row justify-content-center">
                            Test
                        </div>
                    </div>
                </div>
            </div>
        </div>
</div>

<div class="modal fade" id="deletePetModal" tabindex="-1" aria-labelledby="deletePetModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deletePetModalLabel">Confirm Delete</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Are you sure you want to delete this pet?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-dark" data-bs-dismiss="modal">Cancel</button>
          <a href="#" class="btn btn-dark" id="confirmDelete">Delete</a>
        </div>
      </div>
    </div>
</div>
  
{% endblock %}

{% block extrascripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
      var deletePetModal = document.getElementById('deletePetModal');
      deletePetModal.addEventListener('show.bs.modal', function(event) {
        var button = event.relatedTarget;
        var petId = button.getAttribute('data-pet-id');
        var deleteUrl = '{% url "delete-pet-page" 0 %}'.replace('0', petId);
        var confirmDelete = document.getElementById('confirmDelete');
        confirmDelete.onclick = function() {
          fetch(deleteUrl, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'X-CSRFToken': '{{ csrf_token }}'
            }
          }).then(function(response) {
            return response.json();
          }).then(function(data) {
            if (data.result === 'success') {
              location.href = '{% url "pet-list-page" %}';
            } else {
              alert('Error: ' + data.message);
            }
          });
        }
      });
    });
</script>
    
{% endblock %}
